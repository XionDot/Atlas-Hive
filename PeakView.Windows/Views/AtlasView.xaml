<Window x:Class="PeakView.Views.AtlasView"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        mc:Ignorable="d"
        Title="ATLAS MODE - PeakView"
        WindowState="Maximized"
        WindowStyle="None"
        Background="#000000"
        Loaded="Window_Loaded"
        KeyDown="Window_KeyDown">

    <Grid x:Name="RootGrid">
        <!-- Grid Background -->
        <Canvas x:Name="GridCanvas" Panel.ZIndex="0"/>

        <!-- Scanlines (Samaritan Mode only) -->
        <Rectangle x:Name="ScanlinesOverlay"
                  Panel.ZIndex="1"
                  Opacity="0.05"
                  Visibility="Collapsed">
            <Rectangle.Fill>
                <DrawingBrush TileMode="Tile"
                            Viewport="0,0,4,4"
                            ViewportUnits="Absolute">
                    <DrawingBrush.Drawing>
                        <GeometryDrawing Brush="Black">
                            <GeometryDrawing.Geometry>
                                <RectangleGeometry Rect="0,0,4,2"/>
                            </GeometryDrawing.Geometry>
                        </GeometryDrawing>
                    </DrawingBrush.Drawing>
                </DrawingBrush>
            </Rectangle.Fill>
        </Rectangle>

        <!-- Main Content -->
        <Grid x:Name="ContentGrid" Panel.ZIndex="2">
            <!-- Initial Screen: Centered Command Prompt -->
            <StackPanel x:Name="InitialScreen"
                       HorizontalAlignment="Center"
                       VerticalAlignment="Center"
                       Visibility="Visible">

                <!-- Atlas Branding -->
                <TextBlock Text="ATLAS"
                          FontSize="72"
                          FontWeight="Bold"
                          FontFamily="Consolas"
                          Foreground="{StaticResource VibrantBlueBrush}"
                          HorizontalAlignment="Center"
                          Margin="0,0,0,12">
                    <TextBlock.Effect>
                        <DropShadowEffect Color="#3399FF"
                                        BlurRadius="20"
                                        ShadowDepth="0"
                                        Opacity="0.5"/>
                    </TextBlock.Effect>
                </TextBlock>

                <TextBlock x:Name="SubtitleText"
                          Text="System Interface"
                          FontSize="14"
                          FontWeight="Medium"
                          FontFamily="Consolas"
                          Foreground="#999999"
                          HorizontalAlignment="Center"
                          Margin="0,0,0,40"/>

                <!-- Command Prompt -->
                <Border Background="#0D0D0D"
                       BorderBrush="{StaticResource VibrantBlueBrush}"
                       BorderThickness="2"
                       Width="700"
                       Padding="20">
                    <Border.Effect>
                        <DropShadowEffect Color="#3399FF"
                                        BlurRadius="20"
                                        ShadowDepth="0"
                                        Opacity="0.4"/>
                    </Border.Effect>

                    <StackPanel>
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>

                            <TextBlock Text="›"
                                      Grid.Column="0"
                                      FontSize="16"
                                      FontWeight="Bold"
                                      FontFamily="Consolas"
                                      Foreground="{StaticResource VibrantBlueBrush}"
                                      Margin="0,0,12,0"/>

                            <TextBox x:Name="CommandInput"
                                    Grid.Column="1"
                                    FontSize="18"
                                    FontWeight="Medium"
                                    FontFamily="Consolas"
                                    Foreground="#FFFFFF"
                                    Background="Transparent"
                                    BorderThickness="0"
                                    CaretBrush="{StaticResource VibrantBlueBrush}"
                                    TextChanged="CommandInput_TextChanged"
                                    KeyDown="CommandInput_KeyDown"/>
                        </Grid>

                        <!-- Command Suggestions -->
                        <ItemsControl x:Name="SuggestionsPanel"
                                     Margin="0,12,0,0"
                                     Visibility="Collapsed">
                            <ItemsControl.ItemTemplate>
                                <DataTemplate>
                                    <Border Background="#1A1A1A"
                                           Padding="12,8"
                                           Margin="0,0,0,1">
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="24"/>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="Auto"/>
                                            </Grid.ColumnDefinitions>

                                            <TextBlock Grid.Column="0"
                                                      Text="▸"
                                                      FontFamily="Consolas"
                                                      Foreground="{StaticResource VibrantCyanBrush}"
                                                      FontSize="14"/>

                                            <TextBlock Grid.Column="1"
                                                      Text="{Binding Name}"
                                                      FontFamily="Consolas"
                                                      Foreground="#FFFFFF"
                                                      FontSize="13"
                                                      FontWeight="SemiBold"
                                                      Margin="8,0,0,0"/>

                                            <TextBlock Grid.Column="2"
                                                      Text="{Binding Description}"
                                                      FontFamily="Consolas"
                                                      Foreground="#666666"
                                                      FontSize="10"
                                                      FontWeight="Medium"/>
                                        </Grid>
                                    </Border>
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                        </ItemsControl>
                    </StackPanel>
                </Border>

                <!-- Hints -->
                <StackPanel Orientation="Horizontal"
                           HorizontalAlignment="Center"
                           Margin="0,40,0,0"
                           Opacity="0.6">
                    <Border Background="#1A1A1A"
                           BorderBrush="{StaticResource VibrantBlueBrush}"
                           BorderThickness="1"
                           Padding="8,4"
                           Margin="0,0,12,0">
                        <TextBlock Text="⌘K Command Palette"
                                  FontFamily="Consolas"
                                  Foreground="#999999"
                                  FontSize="11"
                                  FontWeight="Medium"/>
                    </Border>

                    <Border Background="#1A1A1A"
                           BorderBrush="{StaticResource VibrantBlueBrush}"
                           BorderThickness="1"
                           Padding="8,4">
                        <TextBlock Text="ESC Reset"
                                  FontFamily="Consolas"
                                  Foreground="#999999"
                                  FontSize="11"
                                  FontWeight="Medium"/>
                    </Border>
                </StackPanel>
            </StackPanel>

            <!-- Widget Screen -->
            <Grid x:Name="WidgetScreen" Visibility="Collapsed">
                <!-- Widget content will be dynamically loaded here -->
                <Border x:Name="WidgetContainer"
                       Background="#0D0D0D"
                       BorderBrush="{StaticResource VibrantBlueBrush}"
                       BorderThickness="2"
                       Padding="30"
                       Margin="30"/>

                <!-- Floating Command Icon (bottom-right) -->
                <Button x:Name="FloatingCommandButton"
                       Width="50"
                       Height="50"
                       HorizontalAlignment="Right"
                       VerticalAlignment="Bottom"
                       Margin="30"
                       Click="FloatingCommandButton_Click"
                       Style="{StaticResource {x:Static ToolBar.ButtonStyleKey}}"
                       Background="{StaticResource DarkBackgroundBrush}"
                       BorderThickness="0">
                    <TextBlock Text="⌘"
                              FontSize="44"
                              FontWeight="Medium"
                              Foreground="{StaticResource VibrantBlueBrush}"
                              Opacity="0.7"/>
                    <Button.Effect>
                        <DropShadowEffect Color="#3399FF"
                                        BlurRadius="10"
                                        ShadowDepth="0"
                                        Opacity="0.3"/>
                    </Button.Effect>
                </Button>

                <!-- Blurred Overlay Command Palette -->
                <Grid x:Name="OverlayCommandPalette"
                     Visibility="Collapsed"
                     Background="#B3000000">
                    <Border Background="#0D0D0D"
                           BorderBrush="{StaticResource VibrantBlueBrush}"
                           BorderThickness="2"
                           Width="700"
                           Padding="20"
                           HorizontalAlignment="Center"
                           VerticalAlignment="Center">
                        <TextBlock Text="Command Palette (TODO)"
                                  FontFamily="Consolas"
                                  Foreground="#FFFFFF"
                                  FontSize="18"/>
                    </Border>
                </Grid>
            </Grid>
        </Grid>
    </Grid>
</Window>
